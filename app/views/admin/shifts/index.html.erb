<div class="page">
  <div class="pageHead">
    <h1 class="pageHead__title">シフト管理</h1>

    <div class="pageHead__actions">
    </div>
  </div>

  <section class="card">
    <div class="card__body">
      <div class="shiftToolbar">
        <div class="filter">
          <div class="filter__label">表示グループ</div>

          <%= form_with url: admin_shifts_path, method: :get, local: true do %>
            <%= select_tag :group_id,
                  options_from_collection_for_select(@groups, :id, :name, @group_id),
                  class: "select select--sm",
                  onchange: "this.form.submit();" %>

            <%= hidden_field_tag :view, @view_mode %>
            <% if @view_mode == "month" %>
              <%= hidden_field_tag :month, @month&.strftime("%Y-%m") %>
            <% else %>
              <%= hidden_field_tag :date, @date&.iso8601 %>
            <% end %>
          <% end %>
        </div>

        <div class="shiftToggle" role="tablist" aria-label="表示切替">
          <%= link_to "月別",
                admin_shifts_path(group_id: @group_id, view: "month", month: (@month || Date.current).strftime("%Y-%m")),
                class: "shiftToggle__btn #{@view_mode == 'month' ? 'is-active' : ''}",
                role: "tab",
                aria: { selected: (@view_mode == "month").to_s } %>

          <%= link_to "日別",
                admin_shifts_path(group_id: @group_id, view: "day", date: (@date || Date.current).iso8601),
                class: "shiftToggle__btn #{@view_mode == 'day' ? 'is-active' : ''}",
                role: "tab",
                aria: { selected: (@view_mode == "day").to_s } %>
        </div>
      </div>

      <% if @group.nil? %>
        <p class="hint">グループが未作成です。先にグループを作成してください。</p>
      <% end %>
    </div>

    <div class="card__body card__body--flush">
      <% if @view_mode == "day" %>
        <%= render "day" %>
      <% else %>
        <%= render "month" %>
      <% end %>
    </div>
  </section>
</div>
